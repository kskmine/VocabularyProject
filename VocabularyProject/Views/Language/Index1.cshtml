@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<div class="row">
    <div class="col-md-3">Id:<input type="text" id="langId" /></div>
    <div class="col-md-3">Code:<input type="text" id="txtCode" /></div>
    <div class="col-md-3">Name:<input type="text" id="txtName" /></div>
    <div class="col-md-3"><input type="button" value="Kaydet" onclick="Save()" /></div>
</div>

<div id="divLangList">

    <table class="table" id="wordsTable">
        <tr>
            <th>ID</th>
            <th>DIL KODU</th>
            <th>DILIN ADI</th>
        </tr>
        <tbody id="langBody">
          
        </tbody>
    </table>
</div>


@section Scripts
{
    <script>
        $(document).ready(getLangData);

        function Save() {
            console.log("save executed: ");
            console.log("id "+$('#langId').val());
            console.log("code " + $('#txtCode').val());
            console.log("name " + $('#txtName').val());

            var data = {
                "id": $('#langId').val(),
                "code": $('#txtCode').val(),
                "name": $('#txtName').val()
            }

            if ($('#langId').val() > 0) {
                $.ajax({
                    type: "PUT",
                    url: "/api/lang" + $('#langId').val(),
                    data: data,
                    success: function (data) {
                        if (data)
                            alert("Kayıt başarılı");
                        getLangData();
                    },
                    dataType: "JSON"
                });
            }
            else {
                $.ajax({
                    type: "POST",
                    url: "/api/lang",
                    data: data,
                    success: function (data) {
                        if (data)
                            alert("Kayıt başarılı");
                        getLangData();
                    },
                    dataType: "JSON"
                });
            }
             ////////////////////////////POSTİSLEMLERİ/////////////////////
            //$.ajax({
            //    type: "POST",
            //    url: "/api/lang",
            //    data: data,
            //    success: function (data) {
            //        if (data)
            //            alert("Kayıt başarılı");
            //        getLangData();
            //    },
            //    dataType: "JSON"
            //});
        }
           
       


        function getLangData() {
           
                // $.get("/api/lang", {}, function (res))
                // $.get(('divLangList').html(result));
                $.ajax({
                    url: "/api/lang",
                    data: null,
                    success: function (res) {
                         console.log(res);
                         $('#langBody').html("");
                        $('#langBody').html("");
                        res.map(function (lng) {
                            //   $('#divLangList').append("<div>"+lng.code+" : "+lng.name+"</div>")
                            $('#langBody').append("<tr><td><input type='button' onclick=edit('" + lng.id + "','" + lng.code + "','" + lng.name + "') value='Edit' /></<td>" + lng.id + "</td><td>" + lng.code + "</td><td>" + lng.name + "</td></tr>")
                        });
                    },
                        /////Başka bir yöntem //Apiyi ekranda göstermek
                        //console.log(res);
                        //$('#langBody').html("");

                        //// $('#divLangList').html(JSON.stringify(res));
                        //res.map(function (lng) {
                        //    // $('#divLangList').append("<div>" + lng.code + " : " + lng.name + "</div>")
                        //    $('#langBody').append("<tr><td>" + lng.id + "</td><td>" + lng.code + "</td><td>" + lng.name + "</td></tr>");
                        //});
                    
                    dataType: "JSON"
                });
        }

        function edit(id, code, name) {
            console.log(id + "--" + code + "--" + name);
            $('#langId').val(id);
            $('#txtCode').val(code);
            $('#txtName').val(name);
        }
    </script>
}